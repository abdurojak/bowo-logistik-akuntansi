import{_ as k}from"./ZlaTK1bf.js";import S from"./BrqrogAf.js";import{U as C,a as N,r as i,o as M,R as m,d as z,V as B,x as P,z as w,L as U,X as R,B as n,N as a,C as u,Q as T,y,D as x,S as h,T as A,A as D,Z as F,_ as H}from"./Dh8vZoxI.js";const I=C("useModuleProfilStore",()=>{const{$apiFetch:V}=N(),o=i(!0);localStorage.getItem("created_by");const d=i(""),p=i(""),t=i(""),v=i(""),f=i(""),g=i(""),b=i(""),c=i(""),e=async()=>{if(t.value===""){m().warning("Password tidak boleh kosong!");return}if(t.value.length<6){m().warning("Password harus minimal 6 karakter!");return}if(t.value!==v.value){m().warning("Password dan konfirmasi password tidak cocok!");return}if(await m().confirmDialog("Anda yakin ingin mengubah profil anda?")){o.value=!0;try{const _=await V("/auth/profile",{method:"PUT",body:{username:d.value,password:t.value,role:f.value,nama:g.value,email:b.value,no_hp:c.value,hint:p.value}});r(),o.value=!1,m().success("Profil berhasil diperbarui!")}catch{m().danger("Gagal memperbarui profil!"),o.value=!1}}},r=async()=>{try{const l=await V("/auth/profile");d.value=l.username||"",t.value="",f.value=l.role||"user",g.value=l.nama||"",b.value=l.email||"",c.value=l.no_hp||"",p.value=l.hint||""}catch(l){throw m().danger("Gagal mengambil data profil!"),l}};return M(()=>{r(),o.value=!1}),{username:d,password:t,role:f,nama:g,email:b,no_hp:c,isLoading:o,hint:p,confirm_password:v,fetchProfil:r,handleUpdate:e}}),L={class:"grid grid-cols-2 md:grid-cols-3 gap-2 py-2"},$={class:"flex justify-end space-x-2 py-2"},j={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"},E={class:"grid items-center text-lg w-full mb-2"},G={class:"grid items-center text-lg w-full mb-2"},K={class:"grid grid-cols-2 items-center text-lg w-full gap-2 pt-2"},Z=z({__name:"index",setup(V){const o=I(),d=i(!1),p=i(null),t=i(!1);function v(){t.value=!t.value}B(d,async c=>{var e,r,l;c&&(await H(),(l=(r=(e=p.value)==null?void 0:e.$el)==null?void 0:r.querySelector("input"))==null||l.focus())});const f=()=>{d.value=!1,o.password="",o.confirm_password=""};function g(){d.value=!0}const b=async()=>{d.value=!1,o.handleUpdate(),f()};return(c,e)=>{const r=k,l=S,_=k;return y(),P(T,null,[w("div",L,[n(r,{modelValue:a(o).username,"onUpdate:modelValue":e[0]||(e[0]=s=>a(o).username=s),label:"Username"},null,8,["modelValue"]),n(r,{modelValue:a(o).nama,"onUpdate:modelValue":e[1]||(e[1]=s=>a(o).nama=s),label:"Nama"},null,8,["modelValue"]),n(r,{modelValue:a(o).email,"onUpdate:modelValue":e[2]||(e[2]=s=>a(o).email=s),label:"Email",type:"email"},null,8,["modelValue"]),n(r,{modelValue:a(o).hint,"onUpdate:modelValue":e[3]||(e[3]=s=>a(o).hint=s),label:"Hint Password"},null,8,["modelValue"]),n(r,{modelValue:a(o).no_hp,"onUpdate:modelValue":e[4]||(e[4]=s=>a(o).no_hp=s),label:"No Hp"},null,8,["modelValue"]),n(r,{modelValue:a(o).role,"onUpdate:modelValue":e[5]||(e[5]=s=>a(o).role=s),label:"Role",disabled:""},null,8,["modelValue"])]),w("div",$,[n(a(h),{color:"green",onClick:g,shadow:"",gradient:"green"},{prefix:u(()=>[n(l,{name:"material-symbols:edit",size:"18"})]),default:u(()=>[e[8]||(e[8]=x(" Update"))]),_:1,__:[8]})]),a(o).isLoading?(y(),P("div",j,[n(a(A),{color:"green",size:"12"})])):U("",!0),a(d)?(y(),R(a(F),{key:1,onClose:f},{header:u(()=>e[9]||(e[9]=[w("span",{class:"text-lg font-semibold dark:text-white"}," Masukkan Password dan Konfirmasi Password ",-1)])),body:u(()=>[w("div",E,[n(_,{modelValue:a(o).password,"onUpdate:modelValue":e[6]||(e[6]=s=>a(o).password=s),label:"Password",ref_key:"inputRef",ref:p,type:a(t)?"text":"password"},null,8,["modelValue","type"])]),w("div",G,[n(_,{modelValue:a(o).confirm_password,"onUpdate:modelValue":e[7]||(e[7]=s=>a(o).confirm_password=s),label:"Konfirmasi Password",type:a(t)?"text":"password"},null,8,["modelValue","type"])]),w("div",K,[n(a(h),{color:"blue",onClick:v,shadow:"",gradient:"blue",class:"w-full"},{prefix:u(()=>[n(l,{name:a(t)?"bx:bxs-hide":"bx:bxs-show",size:"18"},null,8,["name"])]),default:u(()=>[x(" "+D(a(t)?"Hide Password":"Show Password"),1)]),_:1}),n(a(h),{color:"green",onClick:b,shadow:"",gradient:"green",class:"w-full"},{prefix:u(()=>[n(l,{name:"material-symbols:edit",size:"18"})]),default:u(()=>[e[10]||(e[10]=x(" Update Password "))]),_:1,__:[10]})])]),_:1})):U("",!0)],64)}}});export{Z as default};
