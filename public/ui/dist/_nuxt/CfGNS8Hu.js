import{_ as N}from"./DYA8yp-Y.js";/* empty css        */import{_ as z}from"./DfUOK2DD.js";import{_ as x}from"./ZlaTK1bf.js";import{c as S}from"./CwrragXr.js";import{U as O,a as P,r as g,o as j,R as u,d as q,V as F,k as E,x as $,B as _,z as A,X as G,L as U,N as t,C as L,Q as M,y as w,Y as I,A as Q,$ as Y,Z as H,T as X,_ as Z}from"./Dh8vZoxI.js";import"./BFepS9fx.js";import"./BrqrogAf.js";const J=O("useModuleBaganAkunStore",()=>{const R=[{text:"No Akun",value:"no_akun"},{text:"Nama Akun",value:"nama_akun"},{text:"Tipe Akun",value:"nama_tipe"}],{$apiFetch:a}=P(),h=g([]),e=g(!0),p=localStorage.getItem("token"),v={id:0,no_akun:"",nama_akun:"",nama_tipe:"",id_tipe_akun:""},C=g([]),o=g(S(v));function B(r){o.value=r}const k=async({no_akun:r="",nama_akun:i="",id_tipe_akun:d=0}={})=>{const s={};r&&(s.no_akun=r),i&&(s.nama_akun=i),d&&(s.id_tipe_akun=String(d));const c=new URLSearchParams(s).toString();try{const y=await a(`/table-of-akun?${c}`,{headers:{Authorization:`Bearer ${p}`}});h.value=y.map(b=>{var D;return{id:b.id,no_akun:b.no_akun,nama_akun:b.nama_akun,nama_tipe:((D=b.TipeAkun)==null?void 0:D.nama_tipe)??"-",id_tipe_akun:b.id_tipe_akun}})}catch{u().danger("Gagal memuat data!")}},m=async()=>{e.value=!0;const{no_akun:r,nama_akun:i,id_tipe_akun:d}=o.value;await k({no_akun:r||"",nama_akun:i||"",id_tipe_akun:d||0}),e.value=!1,u().success("Pencarian Berhasil!")},n=async()=>{e.value=!0,o.value=S(v),k(),V(),u().success("Form berhasil dibersihkan!"),e.value=!1},f=async()=>{var i,d,s;if(await u().confirmDialog(`Anda ingin membuat transaksi untuk akun ${o.value.nama_akun}?`)){e.value=!0;try{const c=await a("/table-of-akun",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:o.value});o.value.id=c.data.id||0,await k(),e.value=!1,u().success("Akun berhasil dibuat!")}catch(c){const y=((s=(d=(i=c==null?void 0:c.data)==null?void 0:i.errors)==null?void 0:d[0])==null?void 0:s.message)||"Gagal membuat Akun.";e.value=!1,u().danger(y)}}},l=async()=>{var r,i,d;if(o.value.id===0){u().warning("Pilih salah satu data dalam tabel.");return}if(!(o.value.id!==0&&!await u().confirmDialog(`Anda yakin ingin mengubah akun ${o.value.nama_akun}?`))){e.value=!0;try{const s=await a(`/table-of-akun/${o.value.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:o.value});await k(),e.value=!1,u().success("Akun berhasil diperbarui!")}catch(s){const c=((d=(i=(r=s==null?void 0:s.data)==null?void 0:r.errors)==null?void 0:i[0])==null?void 0:d.message)||"Gagal mengubah Akun.";e.value=!1,u().danger(c)}}},T=async()=>{var i,d,s;if(!o.value.id){u().warning("Pilih data yang ingin dihapus.");return}if(await u().confirmDialog(`Yakin ingin menghapus akun ${o.value.nama_akun}?`)){e.value=!0;try{await a(`/table-of-akun/${o.value.id}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`}}),await k(),await n(),e.value=!1,u().success("Akun berhasil dihapus!")}catch(c){const y=((s=(d=(i=c==null?void 0:c.data)==null?void 0:i.errors)==null?void 0:d[0])==null?void 0:s.message)||"Data terhubung dengan tabel lain.";e.value=!1,u().danger(y)}}},V=async()=>{try{const r=await a("/tipe-akun",{headers:{Authorization:`Bearer ${p}`}});C.value=r.map(i=>({value:i.id,name:i.nama_tipe}))}catch(r){console.error("Gagal mengambil data tipe akun:",r)}};return j(()=>{k(),V(),o.value=S(v),e.value=!1}),{fetchData:k,handleDelete:T,handleUpdate:l,handleInsert:f,handleClickRow:B,handleRefresh:n,handleFind:m,tipeAkunOptions:C,form:o,headers:R,items:h,isLoading:e}}),K={class:"grid grid-cols-2 md:grid-cols-3 gap-2 py-2"},W={class:"grid grid-col items-center text-lg w-full"},aa={class:"divide-y divide-green-200 dark:divide-gray-600"},ea=["onClick"],na={class:"flex items-center space-x-2"},ta={class:"text-sm font-medium text-gray-800 dark:text-gray-100"},oa={key:1,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"},ka=q({__name:"index",setup(R){const a=J(),h=g(!1),e=g(""),p=g(null),v=()=>{h.value=!1,e.value=""};F(h,async m=>{var n,f,l;m&&(await Z(),(l=(f=(n=p.value)==null?void 0:n.$el)==null?void 0:f.querySelector("input"))==null||l.focus())});function C(){h.value=!0}const o=E(()=>{const m=e.value.trim().toLowerCase();return a.tipeAkunOptions.filter(n=>n.name.toLowerCase().includes(m)).slice(0,10)}),B=m=>{a.form.nama_tipe=m.name,a.form.id_tipe_akun=m.value,v()};function k(m){a.handleClickRow(m);const n=document.querySelector("main"),f={behavior:"smooth"};n&&n.scrollTo({top:n.scrollHeight,...f})}return(m,n)=>{const f=N;return w(),$(M,null,[_(f,{headers:t(a).headers,items:t(a).items,"is-loading":t(a).isLoading,onClickRow:k},null,8,["headers","items","is-loading"]),A("div",K,[_(x,{modelValue:t(a).form.no_akun,"onUpdate:modelValue":n[0]||(n[0]=l=>t(a).form.no_akun=l),label:"No Akun",type:"number",placeholder:""},null,8,["modelValue"]),_(x,{modelValue:t(a).form.nama_akun,"onUpdate:modelValue":n[1]||(n[1]=l=>t(a).form.nama_akun=l),label:"Nama Akun",placeholder:""},null,8,["modelValue"]),_(x,{modelValue:t(a).form.nama_tipe,"onUpdate:modelValue":n[2]||(n[2]=l=>t(a).form.nama_tipe=l),label:"Tipe Akun",placeholder:"",readonly:"true",onClick:C},null,8,["modelValue"])]),_(z,{"onClick:insert":t(a).handleInsert,"onClick:update":t(a).handleUpdate,"onClick:find":t(a).handleFind,"onClick:refresh":t(a).handleRefresh,"onClick:delete":t(a).handleDelete},null,8,["onClick:insert","onClick:update","onClick:find","onClick:refresh","onClick:delete"]),t(h)?(w(),G(t(H),{key:0,onClose:v},{header:L(()=>[A("div",W,[_(x,{modelValue:t(e),"onUpdate:modelValue":n[3]||(n[3]=l=>Y(e)?e.value=l:null),placeholder:"",label:"Cari Tipe Akun",ref_key:"inputRef",ref:p},null,8,["modelValue"])])]),body:L(()=>[A("ul",aa,[(w(!0),$(M,null,I(t(o),(l,T)=>(w(),$("li",{key:T,onClick:V=>B(l),class:"cursor-pointer px-4 py-2 hover:bg-green-200 dark:hover:bg-gray-500 transition rounded-md"},[A("div",na,[A("div",ta,Q(l.name),1)])],8,ea))),128))])]),_:1})):U("",!0),t(a).isLoading?(w(),$("div",oa,[_(t(X),{color:"green",size:"12"})])):U("",!0)],64)}}});export{ka as default};
