import{_ as x}from"./DnFMIXCs.js";/* empty css        */import{_ as R}from"./BNTRmZPg.js";import{_ as b}from"./BCg2R6iM.js";import{c as h}from"./CwrragXr.js";import{U as S,a as V,r as k,o as B,R as s,d as U,x as y,B as p,z as N,L as z,N as o,Q as A,y as w,T as L}from"./sZQ7zPju.js";import"./DTFxBeDD.js";import"./C6BX5lmX.js";const M=S("useModulePtStore",()=>{const v=[{text:"Nama PT",value:"nama_pt"},{text:"Keterangan",value:"keterangan"}],{$apiFetch:e}=V(),f=k([]),n=k(!0),c=localStorage.getItem("token"),d={id:0,nama_pt:"",keterangan:""},a=k(h(d));function C(i){a.value={id:i.id,nama_pt:i.nama_pt,keterangan:i.keterangan}}const m=async({nama_pt:i="",keterangan:r=""}={})=>{const u={};i&&(u.nama_pt=i),r&&(u.keterangan=r);const l=new URLSearchParams(u).toString();try{const t=await e(`/pt?${l}`,{headers:{Authorization:`Bearer ${c}`}});f.value=t}catch{s().danger("Gagal memuat data!")}},P=async()=>{n.value=!0;const{nama_pt:i,keterangan:r}=a.value;await m({nama_pt:i||"",keterangan:r||""}),n.value=!1,s().success("Pencarian berhasil!")},_=async()=>{n.value=!0,a.value=h(d),await m(),n.value=!1,s().success("Halaman telah di refresh!")},T=async()=>{var r,u,l;if(await s().confirmDialog(`Anda ingin membuat transaksi untuk akun ${a.value.nama_pt}?`)){n.value=!0;try{const t=await e("/pt",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:{nama_pt:a.value.nama_pt,keterangan:a.value.keterangan}});a.value.id=t.data.id||0,await m(),n.value=!1,s().success("PT berhasil dibuat!")}catch(t){const g=((l=(u=(r=t==null?void 0:t.data)==null?void 0:r.errors)==null?void 0:u[0])==null?void 0:l.message)||"Gagal membuat PT.";n.value=!1,s().danger(g)}}},$=async()=>{var i,r,u;if(a.value.id===0){s().warning("Pilih salah satu data dalam tabel.");return}if(!(a.value.id!==0&&!await s().confirmDialog(`Anda yakin ingin mengubah ${a.value.nama_pt}?`))){n.value=!0;try{const l=await e(`/pt/${a.value.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`},body:{nama_pt:a.value.nama_pt,keterangan:a.value.keterangan}});await m(),n.value=!1,s().success("PT berhasil diperbarui!")}catch(l){const t=((u=(r=(i=l==null?void 0:l.data)==null?void 0:i.errors)==null?void 0:r[0])==null?void 0:u.message)||"Gagal mengubah PT.";n.value=!1,s().danger(t)}}},D=async()=>{var r,u,l;if(!a.value.id){s().warning("Pilih data yang ingin dihapus.");return}if(await s().confirmDialog(`Yakin ingin menghapus ${a.value.nama_pt}?`)){n.value=!0;try{await e(`/pt/${a.value.id}`,{method:"DELETE"}),await m(),await _(),n.value=!1,s().success("PT berhasil dihapus!")}catch(t){const g=((l=(u=(r=t==null?void 0:t.data)==null?void 0:r.errors)==null?void 0:u[0])==null?void 0:l.message)||"Data terhubung dengan tabel lain.";n.value=!1,s().danger(g)}}};return B(()=>{m(),a.value=h(d),n.value=!1}),{fetchData:m,handleDelete:D,handleUpdate:$,handleInsert:T,handleFind:P,handleClickRow:C,handleRefresh:_,form:a,headers:v,items:f,isLoading:n}}),j={class:"grid grid-cols-2 gap-2 py-2"},E={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"},Y=U({__name:"index",setup(v){const e=M();function f(n){e.handleClickRow(n);const c=document.querySelector("main"),d={behavior:"smooth"};c&&c.scrollTo({top:c.scrollHeight,...d})}return(n,c)=>{const d=x;return w(),y(A,null,[p(d,{headers:o(e).headers,items:o(e).items,onClickRow:f,"is-loading":o(e).isLoading},null,8,["headers","items","is-loading"]),N("div",j,[p(b,{modelValue:o(e).form.nama_pt,"onUpdate:modelValue":c[0]||(c[0]=a=>o(e).form.nama_pt=a),label:"Nama PT",placeholder:""},null,8,["modelValue"]),p(b,{modelValue:o(e).form.keterangan,"onUpdate:modelValue":c[1]||(c[1]=a=>o(e).form.keterangan=a),label:"Keterangan",placeholder:""},null,8,["modelValue"])]),p(R,{"onClick:insert":o(e).handleInsert,"onClick:update":o(e).handleUpdate,"onClick:find":o(e).handleFind,"onClick:refresh":o(e).handleRefresh,"onClick:delete":o(e).handleDelete},null,8,["onClick:insert","onClick:update","onClick:find","onClick:refresh","onClick:delete"]),o(e).isLoading?(w(),y("div",E,[p(o(L),{color:"green",size:"12"})])):z("",!0)],64)}}});export{Y as default};
