import{_ as N}from"./DnFMIXCs.js";import{_ as T}from"./B-ZN2_Ln.js";/* empty css        */import{_ as E}from"./BNTRmZPg.js";import{_ as h}from"./BCg2R6iM.js";import{c as w}from"./CwrragXr.js";import{U as L,a as M,r as _,o as B,R as m,d as F,x as C,B as c,z as j,L as A,N as s,Q as G,y as x,T as H}from"./sZQ7zPju.js";import"./DTFxBeDD.js";import"./C6BX5lmX.js";const q=L("useModuleUserStore",()=>{const b=[{text:"Nama User",value:"nama"},{text:"Email",value:"email"},{text:"Username",value:"username"},{text:"No Hp",value:"no_hp"},{text:"Role",value:"role"},{text:"Password",value:"password_plain_text"}],{$apiFetch:a}=M(),v=_([]),o=_(!0),l={id:0,nama:"",email:"",username:"",no_hp:"",role:"",password:""},e=_(w(l));function g(r){e.value={id:r.id,nama:r.nama,email:r.email,username:r.username,no_hp:r.no_hp,role:r.role,password:r.password_plain_text}}const n=async({nama:r="",email:u="",username:d="",no_hp:t="",role:i="",password:p=""}={})=>{const U={nama:r,email:u,username:d,no_hp:t,role:i,password:p},k={};for(const f in U){const V=U[f];V!==""&&(k[f]=String(V))}const D=new URLSearchParams(k).toString();try{const f=await a(`/users?${D}`);v.value=f}catch{m().danger("Gagal memuat data!")}},R=async()=>{o.value=!0;const{nama:r,email:u,username:d,no_hp:t,role:i,password:p}=e.value;await n({nama:r||"",email:u||"",username:d||"",no_hp:t||"",role:i||"",password:p||""}),o.value=!1,m().success("Pencarian berhasil!")},y=async()=>{o.value=!0,e.value=w(l),n(),o.value=!1,m().success("Halaman telah di refresh!")},$=async()=>{var u,d,t;if(await m().confirmDialog(`Anda ingin membuat user ${e.value.nama}?`)){o.value=!0;try{const i=await a("/users",{method:"POST",headers:{"Content-Type":"application/json"},body:{nama:e.value.nama,email:e.value.email,username:e.value.username,no_hp:e.value.no_hp,role:e.value.role,password:e.value.password}});await n(),e.value.id=i.data.id||0,o.value=!1,m().success("User berhasil dibuat!")}catch(i){const p=((t=(d=(u=i==null?void 0:i.data)==null?void 0:u.errors)==null?void 0:d[0])==null?void 0:t.message)||"Gagal membuat User.";o.value=!1,m().danger(p)}}},P=async()=>{var r,u,d;if(e.value.id===0){m().warning("Pilih salah satu data dalam tabel.");return}if(!(e.value.id!==0&&!await m().confirmDialog(`Anda yakin ingin mengubah user ${e.value.nama}?`))){o.value=!0;try{const t=await a(`/users/${e.value.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:{nama:e.value.nama,email:e.value.email,username:e.value.username,no_hp:e.value.no_hp,role:e.value.role,password:e.value.password}});await n(),o.value=!1,m().success("User berhasil diperbarui!")}catch(t){const i=((d=(u=(r=t==null?void 0:t.data)==null?void 0:r.errors)==null?void 0:u[0])==null?void 0:d.message)||"Gagal mengubah User.";o.value=!1,m().danger(i)}}},S=async()=>{var u,d,t;if(!e.value.id){m().warning("Pilih data yang ingin dihapus.");return}if(await m().confirmDialog(`Yakin ingin menghapus user ${e.value.nama}?`)){o.value=!0;try{await a(`/users/${e.value.id}`,{method:"DELETE"}),await n(),await y(),o.value=!1,m().success("User berhasil dihapus!")}catch(i){const p=((t=(d=(u=i==null?void 0:i.data)==null?void 0:u.errors)==null?void 0:d[0])==null?void 0:t.message)||"Gagal menghapus User.";o.value=!1,m().danger(p)}}};return B(()=>{n(),e.value=w(l),o.value=!1}),{fetchData:n,handleDelete:S,handleUpdate:P,handleInsert:$,handleFind:R,handleClickRow:g,handleRefresh:y,form:e,headers:b,items:v,isLoading:o}}),z={class:"grid grid-cols-2 md:grid-cols-3 gap-2 py-2"},O={key:0,class:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center"},ae=F({__name:"index",setup(b){const a=q();function v(o){a.handleClickRow(o);const l=document.querySelector("main"),e={behavior:"smooth"};l&&l.scrollTo({top:l.scrollHeight,...e})}return(o,l)=>{const e=N,g=T;return x(),C(G,null,[c(e,{headers:s(a).headers,items:s(a).items,onClickRow:v,"is-loading":s(a).isLoading},null,8,["headers","items","is-loading"]),j("div",z,[c(h,{modelValue:s(a).form.nama,"onUpdate:modelValue":l[0]||(l[0]=n=>s(a).form.nama=n),label:"Nama",placeholder:""},null,8,["modelValue"]),c(h,{modelValue:s(a).form.username,"onUpdate:modelValue":l[1]||(l[1]=n=>s(a).form.username=n),label:"Username",placeholder:""},null,8,["modelValue"]),c(h,{modelValue:s(a).form.password,"onUpdate:modelValue":l[2]||(l[2]=n=>s(a).form.password=n),label:"Password",type:"password",placeholder:""},null,8,["modelValue"]),c(h,{modelValue:s(a).form.email,"onUpdate:modelValue":l[3]||(l[3]=n=>s(a).form.email=n),label:"Email",placeholder:""},null,8,["modelValue"]),c(h,{modelValue:s(a).form.no_hp,"onUpdate:modelValue":l[4]||(l[4]=n=>s(a).form.no_hp=n),label:"No Hp",placeholder:""},null,8,["modelValue"]),c(g,{modelValue:s(a).form.role,"onUpdate:modelValue":l[5]||(l[5]=n=>s(a).form.role=n),label:"Role",placeholder:"---Pilih Role---",options:[{value:"admin",name:"Admin"},{value:"owner",name:"Owner"},{value:"user",name:"User"}]},null,8,["modelValue"])]),c(E,{"onClick:insert":s(a).handleInsert,"onClick:update":s(a).handleUpdate,"onClick:find":s(a).handleFind,"onClick:refresh":s(a).handleRefresh,"onClick:delete":s(a).handleDelete},null,8,["onClick:insert","onClick:update","onClick:find","onClick:refresh","onClick:delete"]),s(a).isLoading?(x(),C("div",O,[c(s(H),{color:"green",size:"12"})])):A("",!0)],64)}}});export{ae as default};
